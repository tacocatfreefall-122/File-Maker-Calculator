<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Complex Calculator</title>
    <style>
        /* General styling */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: #1a1a1a;
            min-height: 100vh;
            color: #e0e0e0;
            padding: 20px;
            padding-bottom: 100px; /* Space for sticky buttons */
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
        }

        .card {
            background: #2a2a2a;
            border-radius: 8px;
            padding: 30px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
        }

        h1 {
            font-size: 2rem;
            color: #ffffff;
            text-align: center;
            margin-bottom: 10px;
            font-weight: 300;
        }

        .subtitle {
            text-align: center;
            color: #888;
            margin-bottom: 30px;
            font-size: 0.95rem;
        }

        /* Modal Styling */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .modal-content {
            background-color: #2a2a2a;
            padding: 20px 30px;
            border-radius: 8px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.5);
            text-align: center;
            width: 90%;
            max-width: 400px;
        }

        .modal-content p {
            font-size: 1.1rem;
            color: #e0e0e0;
            margin-bottom: 20px;
        }

        .modal-buttons {
            display: flex;
            justify-content: space-around;
            gap: 15px;
        }

        .confirm-btn,
        .cancel-btn {
            flex-grow: 1;
            padding: 10px 15px;
            border: none;
            border-radius: 4px;
            font-size: 1rem;
            cursor: pointer;
        }

        .confirm-btn {
            background-color: #e74c3c;
            color: white;
        }
        .cancel-btn {
            background-color: #555;
            color: white;
        }

        /* Password Overlay */
        .hidden {
            display: none !important;
        }
        #passwordOverlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(26, 26, 26, 0.95);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 2000;
        }
        .password-modal {
            background-color: #2a2a2a;
            padding: 30px 40px;
            border-radius: 8px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.5);
            text-align: center;
            width: 90%;
            max-width: 350px;
        }
        .password-modal h1 {
            margin-bottom: 20px;
        }
        .password-modal input {
            width: 100%;
            margin-bottom: 20px;
        }
        .password-modal button {
            width: 100%;
        }
        .error-message {
            color: #e74c3c;
            margin-top: 15px;
            height: 1em; /* Reserve space */
            font-size: 0.9rem;
        }

        /* Form Elements */
        .input-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 6px;
            color: #aaa;
            font-weight: 500;
            font-size: 0.9rem;
        }

        input[type="number"],
        input[type="text"],
        input[type="password"],
        select {
            width: 100%;
            padding: 10px;
            background: #1a1a1a;
            border: 1px solid #444;
            border-radius: 4px;
            color: white;
            font-size: 1rem;
        }
        
        input[type="number"]:focus,
        input[type="text"]:focus,
        input[type="password"]:focus,
        select:focus {
            outline: none;
            border-color: #4a90e2;
        }

        select {
            cursor: pointer;
        }
        
        /* Compact number input layout */
        .number-inputs {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        /* Buttons */
        button {
            background: #4a90e2;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 500;
        }

        .add-btn {
            background: #27ae60;
            width: 100%;
            margin-bottom: 20px;
        }
        
        .add-btn-wrapper {
             padding-top: 5px;
        }

        /* When keyboard is open AND an element inside this item section has focus... */
        body.keyboard-is-active .item-section:focus-within .add-btn-wrapper {
            position: sticky;
            bottom: 0;
            z-index: 101;
            
            /* Add styling to make it look like a floating bar */
            background-color: #2a2a2a; /* Match card background */
            padding: 15px;
            /* Use calc to account for parent padding */
            margin-left: -20px;
            margin-right: -20px;
            margin-bottom: -20px;
            border-top: 1px solid #444;
            border-radius: 0 0 8px 8px; /* Match parent card's bottom corners */
        }

        body.keyboard-is-active .item-section:focus-within .add-btn {
            margin-bottom: 0; /* Remove default margin when sticky */
        }

        .remove-btn {
            background: #e74c3c;
            padding: 6px 12px;
            font-size: 0.85rem;
        }
        
        .reset-btn {
            background: #e67e22;
        }

        /* Item & Pair Containers */
        .pair-container {
            background: #222;
            border: 1px solid #333;
            border-radius: 6px;
            padding: 15px;
            margin-bottom: 15px;
        }

        .pair-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .item-section {
            background: #222;
            border: 1px solid #333;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .item-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid #333;
        }

        .item-title {
            font-size: 1.2rem;
            font-weight: 500;
            color: #fff;
        }

        /* Controls Section */
        .controls-section {
            border-top: 1px solid #444;
            margin-top: 30px;
            padding-top: 30px;
        }

        /* Results Section */
        .results {
            margin-top: 30px;
            padding: 20px;
            background: #1a1a1a;
            border-radius: 6px;
            border: 1px solid #333;
        }

        .results h3 {
            margin-bottom: 15px;
        }

        .result-item {
            margin: 10px 0;
            font-size: 1.1rem;
        }

        .result-item span {
            color: #4a90e2;
            font-weight: 600;
        }

        .results-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
        }

        .item-result {
            background: #2a2a2a;
            border: 1px solid #333;
            border-radius: 6px;
            padding: 15px;
        }

        .item-result h4 {
            color: #4a90e2;
            margin-bottom: 10px;
        }

        /* History Section Styling */
        .history-container {
            margin-top: 20px;
            padding-top: 15px;
            border-top: 1px solid #444;
        }
        
        .history-btn {
            background: #555;
            margin-right: 10px;
            margin-bottom: 10px;
            padding: 8px 16px;
            font-size: 0.9rem;
        }
        
        .clear-history-btn {
            background: #c0392b;
        }

        /* Sticky Buttons */
        .sticky-buttons {
            position: fixed;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            background: #2a2a2a;
            padding: 15px;
            border-top: 1px solid #444;
            border-radius: 8px 8px 0 0;
            box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.3);
            z-index: 100;
            width: 100%;
            max-width: 800px;
            display: flex;
            justify-content: center;
            gap: 10px;
        }

        /* Notifications */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 12px 20px;
            border-radius: 4px;
            color: white;
            font-weight: 500;
            z-index: 1000;
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from {
                transform: translateX(100%);
            }
            to {
                transform: translateX(0);
            }
        }

        .notification.success {
            background: #27ae60;
        }
        .notification.error {
            background: #e74c3c;
        }

        /* Responsive and iOS Styles */
        @media (max-width: 768px) {
            body { padding: 10px; padding-bottom: 150px; }
            .card { padding: 20px 15px; }
            h1 { font-size: 1.5rem; }
            .sticky-buttons { flex-direction: column; }
            button, input, select { min-height: 44px; }
        }

        @supports (-webkit-touch-callout: none) {
            input[type="number"], input[type="text"], select {
                font-size: 16px;
            }
        }
    </style>
</head>
<body>
    <div id="passwordOverlay">
        <div class="password-modal">
            <h1>Enter Password</h1>
            <input type="password" id="passwordInput" placeholder="Password">
            <button id="passwordSubmit">Submit</button>
            <p id="passwordError" class="error-message"></p>
        </div>
    </div>
    
    <div id="customModal" class="modal-overlay" style="display: none;">
        <div class="modal-content">
            <p id="modalMessage"></p>
            <div class="modal-buttons">
                <button id="modalConfirmBtn" class="confirm-btn">Yes, Continue</button>
                <button id="modalCancelBtn" class="cancel-btn">Cancel</button>
            </div>
        </div>
    </div>

    <main id="app-content" class="hidden">
        <div class="container">
            <div class="card">
                <h1>Multi-Item Calculator</h1>
                <p class="subtitle">Add different item categories and calculate</p>

                <div id="itemSections"></div>

                <div class="controls-section">
                    <div class="input-group">
                        <label for="complexCalcId">FSN</label>
                        <input type="text" id="complexCalcId" placeholder="Type the FSN (Optional)" oninput="saveState()">
                    </div>
                    
                    <div class="input-group">
                        <label for="periodSelect">Period:</label>
                        <select id="periodSelect">
                            <option value="Pre-Historic">Pre-Historic</option>
                            <option value="Historic">Historic</option>
                        </select>
                    </div>

                    <div style="display: grid; grid-template-columns: 2fr 1fr; gap: 10px; margin-bottom: 20px;">
                        <div class="input-group">
                            <label for="newItemName">Artifact Type</label>
                            <select id="newItemName">
                                <option value="">-- Select or type custom --</option>
                                <option value="Building Materials">Building Materials</option>
                                <option value="Ceramic">Ceramic</option>
                                <option value="Charcoal">Charcoal</option>
                                <option value="Faunal">Faunal</option>
                                <option value="Floral">Floral</option>
                                <option value="Lithic">Lithic</option>
                                <option value="Shell">Shell</option>
                                <option value="UID">UID</option>
                                <option value="custom">Type your own...</option>
                            </select>
                            <input type="text" id="customItemName" placeholder="Enter custom item name" style="display: none; margin-top: 10px;">
                        </div>
                        <div style="display: flex; align-items: end;">
                            <button style="width: 100%; background: #2c3e50;" onclick="addNewItem()">+ Add Item</button>
                        </div>
                    </div>
                </div>

                <div id="complexResults" class="results" style="display: none;">
                    <h3>Results by Item:</h3>
                    <div id="complexResultsGrid" class="results-grid"></div>
                    <div id="complexHistory" class="history-container"></div>
                </div>
            </div>
        </div>

        <div class="sticky-buttons">
            <button onclick="calculateAll()">Calculate All Totals</button>
            <button class="reset-btn" onclick="resetAll()">Reset All</button>
        </div>
    </main>

    <script>
        let itemCount = 0;
        let pairCounts = {};
        let modalCallback = null;
        let calculationHistory = [];

        function focusInputSafely(input, delay) {
            if (!input) return;

            // This function uses the "dummy input" technique, which is a reliable
            // workaround for WebKit's focus restrictions on iOS.
            // The logic is to satisfy WebKit's requirement for a synchronous focus
            // within a trusted event to raise the keyboard.

            // 1. Create a temporary, invisible input field.
            const dummyInput = document.createElement('input');
            dummyInput.style.position = 'absolute';
            dummyInput.style.opacity = '0';
            dummyInput.style.height = '0';
            dummyInput.style.width = '0';
            // 2. Set font-size to 16px to prevent iOS from auto-zooming into the input.
            dummyInput.style.fontSize = '16px'; 

            // 3. Append to the body and focus it synchronously to trigger the keyboard.
            // This must be done within the same event loop tick as the user interaction.
            document.body.appendChild(dummyInput);
            dummyInput.focus();

            // 4. Use setTimeout to defer focusing the real element and cleaning up.
            // This moves focus to our actual target *after* the keyboard is open.
            setTimeout(() => {
                input.focus();
                // 5. Ensure the focused element is scrolled into view, a best practice
                // to prevent it from being hidden behind the keyboard.
                input.scrollIntoView({ behavior: 'smooth', block: 'center' });
                
                // 6. Clean up by removing the dummy input from the DOM.
                document.body.removeChild(dummyInput);
            }, delay || 100);
        }

        function showNotification(message, type = 'success') {
            document.querySelector('.notification')?.remove();
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.textContent = message;
            document.body.appendChild(notification);
            setTimeout(() => {
                notification.style.opacity = '0';
                setTimeout(() => notification.remove(), 300);
            }, 3000);
        }

        function validateQuantityInput(input) {
            input.value = input.value.replace(/[^\d]/g, '');
            saveState();
        }

        function validateWeightInput(input) {
            let sanitized = input.value.replace(/[^\d.]/g, '');
            const parts = sanitized.split('.');
            if (parts.length > 2) sanitized = parts[0] + '.' + parts.slice(1).join('');
            if (parts[1]) sanitized = parts[0] + '.' + parts[1].substring(0, 1);
            input.value = sanitized;
            saveState();
        }

        function showModal(message, onConfirm) {
            const modal = document.getElementById('customModal');
            document.getElementById('modalMessage').textContent = message;
            modal.style.display = 'flex';
            modalCallback = onConfirm;
        }

        document.getElementById('modalConfirmBtn').onclick = () => {
            document.getElementById('customModal').style.display = 'none';
            if (modalCallback) modalCallback(true);
        };
        document.getElementById('modalCancelBtn').onclick = () => {
            document.getElementById('customModal').style.display = 'none';
            if (modalCallback) modalCallback(false);
        };

        function handleDropdownChange() {
            const dropdown = document.getElementById('newItemName');
            const customInput = document.getElementById('customItemName');
            if (dropdown.value === 'custom') {
                customInput.style.display = 'block';
                focusInputSafely(customInput);
            } else {
                customInput.style.display = 'none';
                customInput.value = '';
            }
        }

        function addNewItem(itemData) {
            let itemName;
            if (itemData) {
                itemName = itemData.name;
            } else {
                const dropdown = document.getElementById('newItemName');
                const customInput = document.getElementById('customItemName');
                let baseItemName = dropdown.value === 'custom' ? customInput.value.trim() : dropdown.value.trim();
                if (!baseItemName) {
                    showNotification('Please select or enter an item name', 'error');
                    return;
                }
                itemName = document.getElementById('periodSelect').value + ' ' + baseItemName;
            }

            itemCount++;
            const itemId = 'item-' + itemCount;
            pairCounts[itemId] = 0;
            const container = document.getElementById('itemSections');
            const itemDiv = document.createElement('div');
            itemDiv.className = 'item-section';
            itemDiv.id = itemId;
            itemDiv.dataset.itemName = itemName;
            itemDiv.innerHTML = `<div class="item-header">
                <div class="item-title">${itemName}</div>
                <button class="remove-btn" onclick="removeItem('${itemId}')">Remove Item</button>
            </div>
            <div id="pairs-${itemId}"></div>
            <div class="add-btn-wrapper">
                <button class="add-btn" onclick="addNumberPair('${itemId}')">+ Add Number Pair</button>
            </div>`;
            container.appendChild(itemDiv);

            if (itemData && itemData.pairs) {
                itemData.pairs.forEach(pair => addNumberPair(itemId, pair));
            } else {
                addNumberPair(itemId);
                document.getElementById('newItemName').value = '';
                document.getElementById('customItemName').value = '';
                document.getElementById('customItemName').style.display = 'none';
                saveState();
            }
            showNotification('Item added', 'success');
        }

        function removeItem(itemId) {
            document.getElementById(itemId)?.remove();
            delete pairCounts[itemId];
            saveState();
        }

        function addNumberPair(itemId, pairData) {
            pairCounts[itemId]++;
            const pairId = pairCounts[itemId];
            const container = document.getElementById('pairs-' + itemId);
            const pairDiv = document.createElement('div');
            pairDiv.className = 'pair-container';
            pairDiv.id = `pair-${itemId}-${pairId}`;
            const qty = pairData ? pairData.quantity : '';
            const wt = pairData ? pairData.weight : '';
            pairDiv.innerHTML = `<div class="pair-header">
                <h4>Pair ${pairId}</h4>
                <button class="remove-btn" onclick="removePair('${itemId}', ${pairId})">Remove</button>
            </div>
            <div class="number-inputs">
                <input type="text" id="num1-${itemId}-${pairId}" value="${qty}" inputmode="numeric" placeholder="Qty" oninput="validateQuantityInput(this)" onkeydown="handleEnterKey(event, '${itemId}', ${pairId}, 1)">
                <input type="text" id="num2-${itemId}-${pairId}" value="${wt}" inputmode="decimal" placeholder="Wt" oninput="validateWeightInput(this)" onkeydown="handleEnterKey(event, '${itemId}', ${pairId}, 2)">
            </div>`;
            container.appendChild(pairDiv);
            if (!pairData) {
                focusInputSafely(document.getElementById(`num1-${itemId}-${pairId}`), 100);
                saveState();
            }
        }

        function removePair(itemId, pairId) {
            document.getElementById(`pair-${itemId}-${pairId}`)?.remove();
            saveState();
        }

        function handleEnterKey(event, itemId, pairId, field) {
            if (event.key === 'Enter') {
                event.preventDefault();
                if (field === 1) focusInputSafely(document.getElementById(`num2-${itemId}-${pairId}`));
                else if (field === 2) addNumberPair(itemId);
            }
        }

        function calculateAll() {
            addToHistory(getCurrentState());
            const results = [];
            document.querySelectorAll('.item-section').forEach(item => {
                const itemId = item.id;
                let totalQuantity = 0, totalWeight = 0;
                item.querySelectorAll('.pair-container').forEach(pair => {
                    const pairId = pair.id.split('-').pop();
                    const quantityInput = document.getElementById(`num1-${itemId}-${pairId}`);
                    const weightInput = document.getElementById(`num2-${itemId}-${pairId}`);
                    if (quantityInput) {
                        totalQuantity += parseInt(quantityInput.value) || 0;
                    }
                    if (weightInput) {
                        totalWeight += parseFloat(weightInput.value) || 0;
                    }
                });
                if (totalQuantity > 0 || totalWeight > 0) {
                    results.push({ name: item.dataset.itemName, quantity: totalQuantity, weight: totalWeight });
                }
            });

            if (results.length > 0) {
                document.getElementById('complexResultsGrid').innerHTML = results.map(r => `
                    <div class="item-result">
                        <h4>${r.name}</h4>
                        <div class="result-item">Quantity: <span>${r.quantity}</span></div>
                        <div class="result-item">Weight: <span>${r.weight.toFixed(1)}</span></div>
                    </div>`).join('');
                document.getElementById('complexResults').style.display = 'block';
                document.getElementById('complexResults').scrollIntoView({ behavior: 'smooth' });
                showNotification('Calculation completed', 'success');
                renderHistoryControls();
            } else {
                showNotification('Please add some data first', 'error');
            }
        }

        function resetAll() {
            if(document.querySelectorAll('.item-section').length === 0 && document.getElementById('complexCalcId').value === '') {
                showNotification('Calculator is already empty', 'error');
                return;
            }
            showModal('This will clear all inputs. Continue?', (confirmed) => {
                if (confirmed) {
                    document.getElementById('itemSections').innerHTML = '';
                    document.getElementById('complexCalcId').value = '';
                    itemCount = 0;
                    pairCounts = {};
                    saveState();
                    
                    document.getElementById('complexResultsGrid').innerHTML = '';

                    if (calculationHistory.length === 0) {
                        document.getElementById('complexResults').style.display = 'none';
                    }
                    
                    showNotification('Inputs cleared', 'success');
                }
            });
        }

        function getCurrentState() {
            const state = { id: document.getElementById('complexCalcId').value, items: [], history: calculationHistory };
            document.querySelectorAll('.item-section').forEach(item => {
                const itemId = item.id;
                const itemData = { name: item.dataset.itemName, pairs: [] };
                item.querySelectorAll('.pair-container').forEach(pair => {
                    const pairId = pair.id.split('-').pop();
                    const quantityInput = document.getElementById(`num1-${itemId}-${pairId}`);
                    const weightInput = document.getElementById(`num2-${itemId}-${pairId}`);
                    itemData.pairs.push({
                        quantity: quantityInput ? quantityInput.value : '',
                        weight: weightInput ? weightInput.value : ''
                    });
                });
                state.items.push(itemData);
            });
            return state;
        }

        function saveState() {
            localStorage.setItem('complexCalculatorState', JSON.stringify(getCurrentState()));
        }

        function renderState(state) {
            document.getElementById('itemSections').innerHTML = '';
            itemCount = 0;
            pairCounts = {};
            document.getElementById('complexCalcId').value = state.id || '';
            state.items?.forEach(item => addNewItem(item));
            calculationHistory = state.history || [];
            renderHistoryControls();
            if (calculationHistory.length > 0) {
                document.getElementById('complexResults').style.display = 'block';
            }
        }
        
        function loadState() {
            const savedState = localStorage.getItem('complexCalculatorState');
            if (savedState) {
                try {
                    renderState(JSON.parse(savedState));
                    showNotification('Previous session restored', 'success');
                } catch (e) { console.error("Failed to parse saved state:", e); }
            }
        }

        function addToHistory(state) {
            calculationHistory.unshift({ ...state, history: undefined });
            if (calculationHistory.length > 3) calculationHistory.pop();
            saveState();
        }

        function loadFromHistory(index) {
            const state = calculationHistory[index];
            if (state) {
                renderState(state);
                showNotification(`Loaded calculation "${state.id || `FSN ${index + 1}`}"`, 'success');
            }
        }

        function clearHistory() {
            showModal('This will permanently delete all saved calculations. Continue?', (confirmed) => {
                if(confirmed) {
                    calculationHistory = [];
                    saveState();
                    renderHistoryControls();
                    document.getElementById('complexResults').style.display = 'none';
                    showNotification('Calculation history cleared', 'success');
                }
            });
        }

        function renderHistoryControls() {
            const container = document.getElementById('complexHistory');
            container.innerHTML = '';
            if (calculationHistory.length > 0) {
                container.innerHTML = '<h4>Calculation History:</h4>';
                calculationHistory.forEach((state, index) => {
                    const btn = document.createElement('button');
                    btn.className = 'history-btn';
                    btn.textContent = `Load "${state.id || `FSN ${index + 1}`}"`;
                    btn.onclick = () => loadFromHistory(index);
                    container.appendChild(btn);
                });
                const clearBtn = document.createElement('button');
                clearBtn.className = 'history-btn clear-history-btn';
                clearBtn.textContent = 'Clear History';
                clearBtn.onclick = clearHistory;
                container.appendChild(clearBtn);
            }
        }

        function checkPassword() {
            const passwordInput = document.getElementById('passwordInput');
            const password = passwordInput.value;
            const errorP = document.getElementById('passwordError');

            if (password === '1625') {
                document.getElementById('passwordOverlay').style.display = 'none';
                document.getElementById('app-content').classList.remove('hidden');
                loadState();
                showNotification('Access granted', 'success');
            } else {
                errorP.textContent = 'Incorrect password. Please try again.';
                passwordInput.value = '';
                passwordInput.focus();
            }
        }

        document.addEventListener('DOMContentLoaded', () => {
            // Setup for password
            const passwordInput = document.getElementById('passwordInput');
            const passwordSubmitBtn = document.getElementById('passwordSubmit');
            passwordSubmitBtn.addEventListener('click', checkPassword);
            passwordInput.addEventListener('keydown', (event) => {
                if (event.key === 'Enter') {
                    event.preventDefault();
                    checkPassword();
                }
            });
            passwordInput.focus();
            
            // Original setup
            document.getElementById('newItemName').addEventListener('change', handleDropdownChange);
            document.getElementById('customItemName').addEventListener('keydown', e => {
                if(e.key === 'Enter') { e.preventDefault(); addNewItem(); }
            });

            const isIOS = () => /iPad|iPhone|iPod/.test(navigator.userAgent);

            if (isIOS()) {
                // This script adds a class to the body when an input is focused on iOS.
                // This allows CSS to add a "spacer" at the bottom of the page,
                // ensuring that content (like the "+ Add Number Pair" button) can be
                // scrolled into view above the on-screen keyboard.
                document.addEventListener('focusin', (e) => {
                    if (e.target.matches('input, textarea')) {
                         document.body.classList.add('keyboard-is-active');
                    }
                });

                document.addEventListener('focusout', (e) => {
                    if (e.target.matches('input, textarea')) {
                         document.body.classList.remove('keyboard-is-active');
                    }
                });
            }
        });

    </script>
</body>
</html>

